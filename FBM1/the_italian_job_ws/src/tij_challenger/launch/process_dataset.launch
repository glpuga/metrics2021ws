<launch>

  <param name="/use_sim_time" value="true" />

  <arg name="dataset"     default="FBM1_flight1.bag" />
  <arg name="loop"        default="false" />
  <arg name="enable_rviz" default="true" />

  <include file="$(find tij_challenger)/launch/metrics_sensors_transformations.launch" />

  <include file="$(find tij_challenger)/launch/replay_dataset_pipeline.launch">
    <arg name="dataset" value="$(arg dataset)" />
    <arg name="loop"    value="$(arg loop)" />
  </include>

  <include file="$(find tij_challenger)/launch/rviz.launch"  if="$(eval enable_rviz)">
    <arg name="rviz_config" value="$(find tij_challenger)/config/config.rviz" />
  </include>

  <!-- OpenVSLAM -->
  <node pkg="openvslam_ros" type="run_slam" name="openvslam"
        args="-v /home/metrics/data/orb_vocab.fbow -c $(find tij_challenger)/config/metrics2021_rgbd.yaml"
        output="screen">
    <remap from="camera/color/image_raw" to="/camera/color/rectified" />
    <remap from="camera/depth/image_raw" to="/camera/depth_registered/image_rect_raw" />
    <param name="odom_frame" value="odom" />
    <param name="map_frame"  value="vicon" />
    <param name="publish_tf" value="true" />
  </node>

</launch>